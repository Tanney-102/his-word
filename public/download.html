<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
</body>
</html>
<script>
  const url = location.search.split("=")[1];
  fetch(url)
      .then(res => res.blob())
      .then(blob => new Promise((resolve, reject) => {
        const reader = new FileReader;
        let imgData
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(blob);
      }))
      .then(imgSource => {
        const imgData = atob(imgSource.split(",")[1]);
        const buf = new ArrayBuffer(imgData.length);
        const view = new Uint8Array(buf);
        for(let i = 0; i < imgData.length; i++) {
          view[i] = imgData.charCodeAt(i) & 0xff;
        }

        const blob = new Blob([view], { type: "image/jpg" });
        window.saveAs(blob, "2021 말씀뽑기.jpg");
      });
</script>